<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Feuille de calcul</title>
    <link rel="stylesheet" type="text/css" href="/css/feuille.css">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body>
    <div class="en-tete d-flex align-items-center">
        <!-- Logo -->
        <img src="/img/icon.png" class="d-inline-block align-top img-logo" alt="Logo">

        <!-- Conteneur pour le titre et le menu -->
        <div class="d-flex flex-column align-items-start">
            <!-- Titre du fichier -->
            <div class="navbar-text" style="padding: 0%;">
                <h5>Nouvelle feuille</h5>
            </div>

            <!-- Barre de menu supérieure -->
            <nav class="navbar navbar-expand-lg navbar-light bg-light" style="padding: 0% !important;">
                <!-- Bouton pour ouvrir le menu -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <!-- Menu déroulant -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                                aria-haspopup="true" aria-expanded="false">
                                Fichier
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <div class="fichierBoutons">
                                    <a class="dropdown-item" href="#" onclick="nouveauFichier()">
                                        <i class="bi-file-earmark-plus"></i>
                                        Nouveau
                                    </a>
                                    <a class="dropdown-item" href="#" onclick="ouvrirFichier()">
                                        <input type="file" id="fileInput" accept=".xlsx" style="display: none;" />
                                        <i class="bi-folder2-open"></i>
                                        Ouvrir
                                    </a>
                                    <a class="dropdown-item" href="#" onclick="enregistrerFichier()">
                                        <i class="bi-save"></i>
                                        Enregistrer
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item" href="#" onclick="fermerFichier()">
                                        <i class="bi-x-lg"></i>
                                        Fermer
                                    </a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>

        <!-- Utilisateurs connectés => test d'affichage, à modifier en js pour afficher seulement les gens en train de modifier la feuille actuelle -->
        <div class="ms-auto utilisateurs">
            <i class="bi bi-people"></i>
            <button class="btn-account" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                <span data-bs-html="true" data-bs-toggle="popover" data-bs-placement="bottom" title="Informations" data-bs-content='Sandy Gehin<br>sandy.gehin@gmail.com'>SG</span>
            </button>

            <button class="btn-account" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                <span data-bs-html="true" data-bs-toggle="popover" data-bs-placement="bottom" title="Informations" data-bs-content='Mathis Georgel<br>mathis.georgel@gmail.com'>MG</span>
            </button>

            <button class="btn-account" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                <span data-bs-html="true" data-bs-toggle="popover" data-bs-placement="bottom" title="Informations" data-bs-content='Quentin Beluche<br>quentin.beluche@gmail.com'>QB</span>
            </button>
        </div>
    </div>



    <!-- Barre d'outils inférieure -->
    <div class="toolbar">
        <button type="button" class="btn btn-secondary">
            <i class="bi bi-type-bold"></i> <!-- Icône Gras -->
        </button>

        <button type="button" class="btn btn-secondary">
            <i class="bi bi-type-italic"></i> <!-- Icône Italique -->
        </button>

        <button type="button" class="btn btn-secondary">
            <i class="bi bi-type-underline"></i> <!-- Icône Souligné -->
        </button>

        <button type="button" class="btn btn-secondary">
            <i class="bi bi-text-left"></i> <!-- Icône texte gauche -->
        </button>

        <button type="button" class="btn btn-secondary">
            <i class="bi bi-text-center"></i> <!-- Icône texte centre -->
        </button>

        <button type="button" class="btn btn-secondary">
            <i class="bi bi-text-right"></i> <!-- Icône texte droite -->
        </button>

        <button type="button" class="btn btn-secondary" id="colorPickerTexte">
            <input type="color" id="colorPicker"> <!-- Choix de la couleur du texte -->
            <i class="bi bi-alphabet-uppercase"></i> <!-- Icône ABC -->
        </button>

        <button type="button" class="btn btn-secondary" id="colorPickerCellule">
            <input type="color" id="colorPicker"> <!-- Choix de la couleur du fond -->
            <i class="bi bi-palette"></i> <!-- Icône palette-->
        </button>
    </div>

    <div class="spreadsheet">
        <table class="table table-bordered" id="myTable">
            <thead>
                <tr>
                    <!-- On génère les cases horizontales en javascript -->
                </tr>
            </thead>
            <tbody>
                <!-- On génère les cases verticales en javascript -->
                <!-- On génère les cases en javascript -->
            </tbody>
        </table>
    </div>
</body>

<!-- Bootstrap JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>

<!-- Script JavaScript personnalisé -->
<script src="/js/creationFeuille.js"></script>
<script src="/js/gestionCellules.js"></script>
<script src="/js/gestionUtilisateurs.js"></script>
<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>

</html>